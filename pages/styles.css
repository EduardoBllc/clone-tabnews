/*
	Animação: Girassol Florescendo
	Referência visual: imagem 'reference.jpg' (campo inclinado, céu azul, nuvens suaves, girassol solitário).

	Acessibilidade:
	- Respeita prefers-reduced-motion (reduz/pausa animações).
	- Cores com bom contraste e sem dependência exclusiva de cor.
*/

:root {
  /* Cores ajustadas para aproximar da referência (céu mais suave, grama amarelada) */
  --sky-top: #88b3e1;
  --sky-bottom: #cfe6fb;
  --grass-1: #5e8f3b; /* base mais fria/escura */
  --grass-2: #86b24a; /* topo mais amarelado */
  --petal: #f5c21a;
  --petal-shadow: #e1a609;
  --center: #6b4a27;
  --center-inner: #3d2b16;
  --leaf: #2f7a3b;
  --leaf-light: #3f964d;

  --t-grow: 2200ms;
  --t-petals: 1800ms;
  --t-center: 900ms;
  --t-delay-stem: 200ms;
  --t-delay-leaf-1: 500ms;
  --t-delay-leaf-2: 800ms;
  --t-delay-petals: 1200ms;
  /* Ponto de início para o miolo: depois do caule terminar */
  --t-after-stem: calc(var(--t-delay-stem) + var(--t-grow) + 120ms);
  /* Ponto de início para o balanço: depois das pétalas abrirem */
  --t-after-petals: calc(var(--t-after-stem) + var(--t-petals) + 200ms);
  /* Atraso para a mensagem no céu aparecer depois da flor abrir */
  --t-delay-sky: calc(var(--t-after-petals) + 400ms);
}

* {
  box-sizing: border-box;
}
html,
body {
  height: 100%;
}
body {
  margin: 0;
  font-family:
    system-ui,
    -apple-system,
    Segoe UI,
    Roboto,
    Ubuntu,
    Cantarell,
    "Helvetica Neue",
    Arial,
    "Noto Sans",
    sans-serif;
  color: #17323c;
}

.scene {
  position: relative;
  min-height: 100svh;
  overflow: hidden;
  display: grid;
  place-items: end center;
  /* Céu com leve radial para sensação de iluminação */
  background:
    radial-gradient(120% 80% at 65% 30%, #ffffff1a 0%, #ffffff00 60%),
    linear-gradient(to bottom, var(--sky-top), var(--sky-bottom));
}

/* Texto animado no céu */
.sky-text {
  position: absolute;
  top: 8%;
  left: 50%;
  transform: translateX(-50%) translateY(-8px);
  z-index: 3; /* acima das nuvens */
  font-weight: 700;
  font-size: clamp(20px, 4.2vw, 42px);
  letter-spacing: 0.5px;
  color: #ffffff;
  text-shadow:
    0 2px 8px rgba(0, 0, 0, 0.25),
    0 0 18px rgba(255, 255, 255, 0.35);
  opacity: 0;
  animation: sky-text-in 900ms ease-out var(--t-delay-sky) forwards;
  padding: 6px 14px;
  border-radius: 10px;
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.08),
    rgba(255, 255, 255, 0.02)
  );
  backdrop-filter: blur(1px) saturate(1.05);
}

@keyframes sky-text-in {
  0% {
    opacity: 0;
    transform: translateX(-50%) translateY(-12px) scale(0.98);
    filter: blur(1px);
  }
  60% {
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(1.02);
  }
  100% {
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(1);
    filter: blur(0);
  }
}

/* Colina principal (sem inclinar a cena; usamos recorte da forma) */
.scene::after {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 52%;
  background:
    radial-gradient(
      80% 60% at 18% 35%,
      rgba(255, 255, 255, 0.22) 0%,
      rgba(255, 255, 255, 0) 55%
    ),
    linear-gradient(0deg, var(--grass-1), var(--grass-2));
  /* recorte para formar a rampa, sem rotacionar o elemento */
  clip-path: polygon(0 55%, 100% 35%, 100% 100%, 0 100%);
  filter: saturate(1.05);
}

/* Nuvens fofas com sombras suaves (wrapper anima, nuvem interna mantém o scale) */
.cloud-wrap {
  position: absolute;
  z-index: 1;
  animation: cloud-drift 38s linear infinite;
}
.cloud {
  width: 170px;
  height: 60px;
  background: #ffffffcc;
  border-radius: 50px;
  filter: blur(0.2px);
  box-shadow:
    30px -15px 0 8px #ffffffcc,
    70px -5px 0 18px #ffffffcc,
    110px -20px 0 10px #ffffffcc;
  transform: scale(var(--scale, 1));
}
.cloud--a {
  left: -20%;
  top: 18%;
  animation-delay: -8s;
  opacity: 0.9;
}
.cloud--b {
  left: 60%;
  top: 10%;
  --scale: 0.8;
  opacity: 0.8;
  animation-duration: 46s;
}
.cloud--c {
  left: -30%;
  top: 8%;
  opacity: 0.7;
  animation-duration: 52s;
  animation-delay: -20s;
}
.cloud--c .cloud {
  width: 220px;
  height: 70px;
}
.cloud--d {
  left: 30%;
  top: 22%;
  opacity: 0.85;
  animation-duration: 34s;
}
.cloud--d .cloud {
  width: 130px;
  height: 48px;
}

@keyframes cloud-drift {
  to {
    transform: translateX(160%);
  }
}

/* SVG dimensionamento responsivo */
.sunflower {
  width: min(80vmin, 520px);
  height: auto;
  z-index: 2;
}

/* Estilos base das formas */
.sunflower .shadow {
  fill: #1a3a1a22;
}

.stem .stem-core {
  /* Gradiente do caule para volume */
  fill: url(#leaf-grad);
  transform-origin: center bottom;
  transform: scaleY(0.1);
  animation: stem-grow var(--t-grow) cubic-bezier(0.2, 0.8, 0.2, 1)
    var(--t-delay-stem) forwards;
  /* Remover contorno do caule */
  stroke: none;
}
.stem .stem-highlight {
  fill: url(#stem-highlight);
  transform-origin: center bottom;
  transform: scaleY(0.1);
  animation: stem-grow var(--t-grow) cubic-bezier(0.2, 0.8, 0.2, 1)
    calc(var(--t-delay-stem) + 30ms) forwards;
  opacity: 0.6;
}

.leaf path {
  /* Usa gradiente SVG definido em <defs>. Removemos fallback inválido para SVG */
  fill: url(#leaf-grad);
  transform-origin: center;
  transform: scale(0) rotate(-6deg);
}
.leaf .leaf-grain,
.leaf .leaf-highlight {
  transform-origin: center;
  transform: scale(0) rotate(-6deg);
}
.leaf--left path {
  animation: leaf-pop var(--t-grow) cubic-bezier(0.2, 0.8, 0.2, 1)
    var(--t-delay-leaf-1) forwards;
}
.leaf--right path {
  animation: leaf-pop var(--t-grow) cubic-bezier(0.2, 0.8, 0.2, 1)
    var(--t-delay-leaf-2) forwards;
}
.leaf--left .leaf-grain,
.leaf--left .leaf-highlight {
  animation: leaf-pop var(--t-grow) cubic-bezier(0.2, 0.8, 0.2, 1)
    var(--t-delay-leaf-1) forwards;
}
.leaf--right .leaf-grain,
.leaf--right .leaf-highlight {
  animation: leaf-pop var(--t-grow) cubic-bezier(0.2, 0.8, 0.2, 1)
    var(--t-delay-leaf-2) forwards;
}

/* Textura e highlight nas folhas */
.leaf-grain {
  fill: #fff;
  filter: url(#grain);
  opacity: 0.16;
  mix-blend-mode: multiply;
}
.leaf-highlight {
  fill: url(#leaf-highlight);
  opacity: 0.28;
  mix-blend-mode: screen;
}

.flower {
  transform-origin: 0 110px;
  animation: sway 6.5s ease-in-out var(--t-after-petals) infinite alternate;
}

/* Cálice (receptáculo) – surge junto com o início das pétalas */
.calyx path {
  transform-origin: center;
  transform: scale(0.6);
  opacity: 0;
  filter: drop-shadow(0 1px 0 #00000022);
  animation: calyx-in 600ms ease-out var(--t-after-stem) forwards;
}

.petals .petal-ring {
  transform-origin: 0 0;
  transform: scale(0.1) rotate(-8deg);
  filter: drop-shadow(0 1px 0 #00000022);
  opacity: 0;
  animation: petals-open var(--t-petals) cubic-bezier(0.16, 0.87, 0.29, 1)
    var(--t-after-stem) forwards;
  /* Aplica o grão apenas nas pétalas (evita artefatos de camada no SVG inteiro) */
  filter: drop-shadow(0 1px 0 #00000022) url(#grain);
}
.petal-ring--inner {
  transform: scale(0.08) rotate(-8deg);
  animation-delay: calc(var(--t-after-stem) + 120ms);
  opacity: 0.96;
}
.petals use {
  fill: url(#petal-grad);
}
.petals use:nth-child(odd) {
  fill: url(#petal-grad-alt);
}
/* Variação sutil de cor entre pétalas para efeito mais orgânico */
.petals .petal-ring use:nth-child(3n + 1) {
  filter: hue-rotate(-2deg) saturate(1.03) brightness(1.02);
}
.petals .petal-ring use:nth-child(3n + 2) {
  filter: hue-rotate(1.5deg) saturate(1.02);
}
.petals .petal-ring use:nth-child(3n) {
  filter: hue-rotate(0deg) saturate(1);
}
.petal-ring--inner use:nth-child(2n) {
  filter: hue-rotate(-1deg) brightness(1.01);
}

.center .disk {
  fill: var(--center);
  transform: scale(0.2);
  opacity: 0;
  animation: center-in var(--t-center) ease-out var(--t-after-stem) forwards;
}
.center .disk--inner {
  fill: var(--center-inner);
  transform: scale(0.1);
  opacity: 0;
  animation: center-in var(--t-center) ease-out
    calc(var(--t-after-stem) + 180ms) forwards;
}
.center .seed-pattern {
  mix-blend-mode: multiply;
  filter: url(#grain);
  opacity: 0;
  transform: scale(0.85);
  animation: center-in var(--t-center) ease-out
    calc(var(--t-after-stem) + 320ms) forwards;
}

/* Keyframes */
@keyframes stem-grow {
  0% {
    transform: scaleY(0.1);
  }
  60% {
    transform: scaleY(1.05);
  }
  100% {
    transform: scaleY(1);
  }
}
@keyframes leaf-pop {
  0% {
    transform: scale(0) rotate(-10deg);
    opacity: 0;
  }
  70% {
    transform: scale(1.06) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: scale(1) rotate(0deg);
  }
}
@keyframes petals-open {
  0% {
    transform: scale(0.1) rotate(-8deg);
    opacity: 0;
  }
  60% {
    transform: scale(1.06) rotate(3deg);
    opacity: 1;
  }
  100% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}

@keyframes calyx-in {
  0% {
    transform: scale(0.6);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}
@keyframes center-in {
  0% {
    transform: scale(0.2);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}
@keyframes sway {
  0% {
    transform: rotate(-2.2deg);
  }
  100% {
    transform: rotate(1.6deg);
  }
}

/* Colina distante para perspectiva e profundidade (sem rotação do elemento) */
.scene::before {
  content: "";
  position: absolute;
  left: -5%;
  right: -5%;
  bottom: 24%;
  height: 32%;
  background: linear-gradient(0deg, #74a857, #97c46b);
  clip-path: polygon(0 62%, 100% 48%, 100% 100%, 0 100%);
  opacity: 0.55;
  animation: hill-parallax 40s ease-in-out infinite alternate;
}

/* Ajuste de perspectiva da sombra no chão */
.sunflower .shadow {
  /* sombra mais suave, sem inclinar a cena */
  transform: scaleX(1.15) scaleY(0.9);
  transform-origin: center;
  animation: shadow-sway 6.5s ease-in-out var(--t-after-petals) infinite
    alternate;
}

/* Textura sutil no céu/grama (overlay) */
.texture {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  background-image:
    radial-gradient(
      circle at 25% 20%,
      rgba(0, 0, 0, 0.04) 0 1px,
      transparent 1px
    ),
    radial-gradient(
      circle at 70% 80%,
      rgba(0, 0, 0, 0.035) 0 1px,
      transparent 1px
    );
  background-size:
    3px 3px,
    4px 4px;
  opacity: 0.25;
}

/* Textura sutil na grama, recortada pela mesma forma da colina principal */
.grass-texture {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 52%;
  pointer-events: none;
  z-index: 0; /* abaixo das nuvens */
  clip-path: polygon(0 55%, 100% 35%, 100% 100%, 0 100%);
  background: repeating-linear-gradient(
    -12deg,
    rgba(0, 0, 0, 0.04) 0 6px,
    rgba(255, 255, 255, 0.025) 6px 12px
  );
  opacity: 0.18;
  mix-blend-mode: multiply;
}

@keyframes hill-parallax {
  0% {
    transform: translateX(-1.2%);
  }
  100% {
    transform: translateX(1.2%);
  }
}

/* Diminui movimento para quem prefere menos animação */
@media (prefers-reduced-motion: reduce) {
  /* Sombra acompanha levemente o balanço da flor */
  @keyframes shadow-sway {
    0% {
      transform: translateX(-4px) scaleX(1.15) scaleY(0.9);
    }
    100% {
      transform: translateX(4px) scaleX(1.2) scaleY(0.9);
    }
  }
  .cloud-wrap {
    animation: none;
  }
  .flower {
    animation: none;
  }
  .scene::before {
    animation: none;
  }
  .sky-text {
    animation: none;
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
  .stem .stem-core,
  .stem .stem-highlight,
  .leaf path,
  .petals .petal-ring,
  .center .disk,
  .center .disk--inner,
  .center .seed-pattern {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
  }
}
